
# 問題 2.76

## 汎用演算を使った巨大システムが発展すると, 新しいデータオブジェクトの型や, 新しい演算が必要になる. 三つの戦略---明白な振分けを持つ汎用演算, データ主導流, メッセージパッシング流---のそれぞれにつき, 新しい型や新しい演算を追加する時, システムに施すべき変更につき述べよ. 新しい型が絶えず追加されるシステムにはどの方法が最も適切か. 新しい演算が絶えず追加されるシステムには, どれが最も適切か.

## 1. 新しい型や新しい演算を追加する時, システムに施すべき変更
### 明白な振分けを持つ汎用演算
 - 新しい型を追加するときに必要な変更
 -- 新しい型に対応する選択肢を増やす。既存の選択肢すべてに、新しい型に対応する実装(newtype? および、newtype 実装) が必要
 -- 名前空間に make-from-newtype といった関数を定義しなければならない
 - 新しい演算を追加するときに必要な変更
 -- 新しい演算を、既存の各タグごとに追加する

### データ主導
- 新しい型を追加するときに必要な変更
-- 新しいパッケージを用意(既存の、公開インタフェースを実装する)
- 新しい演算を追加するときに必要な変更
-- 既存の公開インタフェースに演算をそれぞれ追加する

### メッセージパッシング
- 新しい型を追加するときに必要な変更
-- 新しいデータオブジェクト作成用の関数を作成する
- 新しい演算を追加するときに必要な変更
-- 新しいデータオブジェクト作成用の関数に、型ごとの既存の演算を実装する


## 2. 新しい型や新しい演算を追加する時, システムに施すべき変更で最も適切なもの

### 新しい型が絶えず追加されるシステムにはどの方法が最も適切か?
メッセージパッシング
- なぜなら、型を追加するだけでよく、既存のシステムは、知らないメッセージで例外を上げてくれるから。

### 新しい演算が絶えず追加されるシステムにはどの方法が最も適切か?
- 手間を考慮したら
明白な型振り分けを持つ汎用演算 か メッセージパッシング.
ではあるが、型の振り分けによる方は、演算が増えれば増えるほど変更範囲(記述量)が増えるので、
メンテナンスを考慮したらメッセージパッシングのほうが適切?

- 堅牢な公開インタフェースを考慮
データ主導

